# Mutable entities - these can be updated after creation
type Ticket @entity(immutable: false) {
  id: ID!
  tokenId: BigInt!
  owner: Account!
  uri: String!
  isUsed: Boolean!
  originalPrice: BigInt!
  price: BigInt
  transfers: [Transfer!]! @derivedFrom(field: "ticket")
}

type Account @entity(immutable: false) {
  id: ID! # Wallet address
  tickets: [Ticket!]! @derivedFrom(field: "owner")
  marketplacesApproved: [MarketplaceApproval!]! @derivedFrom(field: "account")
}

# Immutable entities - these are never updated after creation (events)
type Transfer @entity(immutable: true) {
  id: ID!
  ticket: Ticket!
  from: Account!
  to: Account!
  price: BigInt!
  royaltyAmount: BigInt!
  transactionHash: Bytes!
  timestamp: BigInt!
}

type MarketplaceApproval @entity(immutable: true) {
  id: ID!
  account: Account!
  marketplace: Bytes!
  isApproved: Boolean!
  timestamp: BigInt!
}

type ProtocolStats @entity(immutable: false) {
  id: ID!
  totalTicketsMinted: BigInt!
  totalTicketsUsed: BigInt!
  totalVolume: BigInt!
  totalRoyalties: BigInt!
}
